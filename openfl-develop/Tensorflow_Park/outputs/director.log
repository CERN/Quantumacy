[14:51:45] INFO     ðŸ§¿ Starting the Director Service.                                                                                             director.py:47
           INFO     Sample shape: ['128', '128', '1'], target shape: ['1']                                                                        director.py:53
           INFO     Starting server on localhost:50051                                                                                     director_server.py:99
[14:51:50] INFO     AcknowledgeShard request has got: node_info {                                                                         director_server.py:105
                      name: "env_one"                                                                                                                           
                    }                                                                                                                                           
                    shard_description: "Mnist dataset, shard number 1 out of 2"                                                                                 
                    sample_shape: "128"                                                                                                                         
                    sample_shape: "128"                                                                                                                         
                    sample_shape: "1"                                                                                                                           
                    target_shape: "1"                                                                                                                           
                                                                                                                                                                
           INFO     Request was accepted                                                                                                          director.py:62
           INFO     Request WaitExperiment has got!                                                                                       director_server.py:183
           INFO     collaborator_name: "env_one"                                                                                          director_server.py:185
                                                                                                                                                                
[14:51:58] INFO     Request GetDatasetInfo has got!                                                                                       director_server.py:193
           INFO     Shard registry: {'env_one': {'shard_info': node_info {                                                                       director.py:193
                      name: "env_one"                                                                                                                           
                    }                                                                                                                                           
                    shard_description: "Mnist dataset, shard number 1 out of 2"                                                                                 
                    sample_shape: "128"                                                                                                                         
                    sample_shape: "128"                                                                                                                         
                    sample_shape: "1"                                                                                                                           
                    target_shape: "1"                                                                                                                           
                    , 'is_online': True, 'is_experiment_running': False, 'valid_duration': 120, 'last_updated': 1648731110.478566}}                             
[14:52:00] INFO     Shard registry: {'env_one': {'shard_info': node_info {                                                                       director.py:193
                      name: "env_one"                                                                                                                           
                    }                                                                                                                                           
                    shard_description: "Mnist dataset, shard number 1 out of 2"                                                                                 
                    sample_shape: "128"                                                                                                                         
                    sample_shape: "128"                                                                                                                         
                    sample_shape: "1"                                                                                                                           
                    target_shape: "1"                                                                                                                           
                    , 'is_online': True, 'is_experiment_running': False, 'valid_duration': 120, 'last_updated': 1648731110.478566}}                             
           INFO     SetNewExperiment request has got <grpc._cython.cygrpc._MessageReceiver object at 0x168266b80>                         director_server.py:113
           INFO     New experiment mnist_experiment for collaborators ['env_one']                                                                 director.py:93
           INFO     Send response                                                                                                         director_server.py:137
           INFO     FL-Plan hash is cb2b58f99f70066bfd63cad085340da1bbd8342f74170643df6f642cf1ebea122e0a34ede65a184965730ea7d99a848b                 plan.py:231
           INFO     FL-Plan hash is cb2b58f99f70066bfd63cad085340da1bbd8342f74170643df6f642cf1ebea122e0a34ede65a184965730ea7d99a848b                 plan.py:231
           INFO     Parsing Federated Learning Plan : SUCCESS : plan/plan.yaml.                                                                      plan.py:141
           INFO     aggregator:                                                                                                                      plan.py:145
                      settings:                                                                                                                                 
                        best_state_path: save/best.pbuf                                                                                                         
                        db_store_rounds: 1                                                                                                                      
                        init_state_path: save/init.pbuf                                                                                                         
                        last_state_path: save/last.pbuf                                                                                                         
                        rounds_to_train: 5                                                                                                                      
                      template: openfl.component.Aggregator                                                                                                     
                    api_layer:                                                                                                                                  
                      required_plugin_components:                                                                                                               
                        serializer_plugin: openfl.plugins.interface_serializer.cloudpickle_serializer.CloudpickleSerializer                                     
                      settings:                                                                                                                                 
                        dataloader_interface_file: loader_obj.pkl                                                                                               
                        model_interface_file: model_obj.pkl                                                                                                     
                        tasks_interface_file: tasks_obj.pkl                                                                                                     
                    assigner:                                                                                                                                   
                      settings:                                                                                                                                 
                        task_groups:                                                                                                                            
                        - name: train_and_validate                                                                                                              
                          percentage: 1.0                                                                                                                       
                          tasks:                                                                                                                                
                          - train                                                                                                                               
                      template: openfl.component.RandomGroupedAssigner                                                                                          
                    collaborator:                                                                                                                               
                      settings:                                                                                                                                 
                        db_store_rounds: 1                                                                                                                      
                        delta_updates: false                                                                                                                    
                        opt_treatment: CONTINUE_GLOBAL                                                                                                          
                      template: openfl.component.Collaborator                                                                                                   
                    data_loader:                                                                                                                                
                      settings:                                                                                                                                 
                        train_bs: 64                                                                                                                            
                        valid_bs: 64                                                                                                                            
                      template: openfl.federated.DataLoader                                                                                                     
                    network:                                                                                                                                    
                      settings:                                                                                                                                 
                        agg_addr: localhost                                                                                                                     
                        agg_port: 3002                                                                                                                          
                        cert_folder: cert                                                                                                                       
                        client_reconnect_interval: 5                                                                                                            
                        disable_client_auth: false                                                                                                              
                        hash_salt: auto                                                                                                                         
                        tls: false                                                                                                                              
                      template: openfl.federation.Network                                                                                                       
                    task_runner:                                                                                                                                
                      required_plugin_components:                                                                                                               
                        framework_adapters: openfl.plugins.frameworks_adapters.keras_adapter.FrameworkAdapterPlugin                                             
                      settings: {}                                                                                                                              
                      template: openfl.federated.task.task_runner.CoreTaskRunner                                                                                
                    tasks:                                                                                                                                      
                      settings: {}                                                                                                                              
                      train:                                                                                                                                    
                        function: train                                                                                                                         
                        kwargs: {}                                                                                                                              
                                                                                                                                                                
           INFO     ðŸ§¿ Starting the Aggregator Service.                                                                                          director.py:232
           INFO     Building ðŸ¡† Object RandomGroupedAssigner from openfl.component Module.                                                            plan.py:170
           INFO     Settings ðŸ¡† {'task_groups': [{'name': 'train_and_validate', 'percentage': 1.0, 'tasks': ['train']}], 'authorized_cols':           plan.py:173
                    ['env_one'], 'rounds_to_train': 5, 'tasks': {'train': {'function': 'train', 'kwargs': {}, 'aggregation_type':                               
                    <openfl.component.aggregation_functions.weighted_average.WeightedAverage object at 0x168240df0>}}}                                          
           INFO     Override ðŸ¡† {}                                                                                                                    plan.py:175
           INFO     Building ðŸ¡† Object NoCompressionPipeline from openfl.pipelines Module.                                                            plan.py:170
           INFO     Settings ðŸ¡† {}                                                                                                                    plan.py:173
           INFO     Override ðŸ¡† {}                                                                                                                    plan.py:175
           INFO     Building ðŸ¡† Object Aggregator from openfl.component Module.                                                                       plan.py:170
           INFO     Settings ðŸ¡† {'best_state_path': 'save/best.pbuf', 'db_store_rounds': 1, 'init_state_path': 'save/init.pbuf', 'last_state_path':   plan.py:173
                    'save/last.pbuf', 'rounds_to_train': 5, 'aggregator_uuid': 'aggregator_plan.yaml_cb2b58f9', 'federation_uuid':                              
                    'plan.yaml_cb2b58f9', 'authorized_cols': ['env_one'], 'assigner':                                                                           
                    <openfl.component.assigner.random_grouped_assigner.RandomGroupedAssigner object at 0x168240dc0>, 'compression_pipeline':                    
                    <openfl.pipelines.no_compression_pipeline.NoCompressionPipeline object at 0x168240f70>, 'log_metric_callback': None}                        
           INFO     Override ðŸ¡† {'initial_tensor_dict': {'dense/kernel:0': array([[ 0.00605654],                                                      plan.py:175
                           [-0.01490679],                                                                                                                       
                           [ 0.01110882],                                                                                                                       
                           ...,                                                                                                                                 
                           [ 0.0106455 ],                                                                                                                       
                           [-0.00810834],                                                                                                                       
                           [-0.01736839]], dtype=float32), 'dense/bias:0': array([0.], dtype=float32)}}                                                         
           INFO     Insecure port: 3002                                                                                                            server.py:325
           INFO     Starting Aggregator gRPC Server                                                                                              director.py:244
           INFO     Experiment mnist_experiment was prepared                                                                              director_server.py:187
           INFO     Request StreamMetrics for mnist_experiment experiment has got!                                                        director_server.py:204
[14:52:02] INFO     getting key                                                                                                                    server.py:153
           ERROR    Exception calling application: [Errno 61] Connection refused                                                                  _server.py:453
                    Traceback (most recent call last):                                                                                                          
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/site-packages/grpc/_server.py", line 443, in                        
                    _call_behavior                                                                                                                              
                        response_or_iterator = behavior(argument, context)                                                                                      
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/site-packages/openfl/transport/grpc/server.py", line                
                    154, in GetKey                                                                                                                              
                        key = self.get_key(collaborator_name)                                                                                                   
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/site-packages/openfl/transport/grpc/server.py", line                
                    366, in get_key                                                                                                                             
                        conn.request("GET", "/test?ID=" + id)                                                                                                   
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/http/client.py", line 1256, in request                              
                        self._send_request(method, url, body, headers, encode_chunked)                                                                          
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/http/client.py", line 1302, in _send_request                        
                        self.endheaders(body, encode_chunked=encode_chunked)                                                                                    
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/http/client.py", line 1251, in endheaders                           
                        self._send_output(message_body, encode_chunked=encode_chunked)                                                                          
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/http/client.py", line 1011, in _send_output                         
                        self.send(msg)                                                                                                                          
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/http/client.py", line 951, in send                                  
                        self.connect()                                                                                                                          
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/http/client.py", line 922, in connect                               
                        self.sock = self._create_connection(                                                                                                    
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/socket.py", line 808, in create_connection                          
                        raise err                                                                                                                               
                      File "/opt/homebrew/Caskroom/miniforge/base/envs/openfl/lib/python3.8/socket.py", line 796, in create_connection                          
                        sock.connect(sa)                                                                                                                        
                    ConnectionRefusedError: [Errno 61] Connection refused                                                                                       
           INFO     Request WaitExperiment has got!                                                                                       director_server.py:183
           INFO     collaborator_name: "env_one"                                                                                          director_server.py:185
                                                                                                                                                                

Aborted!
